<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KT 공식 인증 대리점 특가몰</title>

    <!-- [Naver Search Advisor] 네이버 소유확인 태그 -->
    <meta name="naver-site-verification" content="b4b6f91c837c5946c62c9937cf39b17f80178fb3" />

    <!-- [SEO] 검색 엔진 최적화 -->
    <meta name="description" content="KT 공식 온라인 대리점 가우리엔터프라이즈 특가몰입니다. 갤럭시 S25, 아이폰17 등 최신 스마트폰 최저가 상담 및 인터넷+TV 결합할인 혜택을 만나보세요.">
    <meta name="keywords" content="KT대리점, KT온라인샵, 핸드폰성지, 갤럭시S25, 아이폰17, 인터넷가입, 가우리엔터프라이즈">
    
    <!-- [Open Graph] 카카오톡/블로그 공유 시 정보 -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="KT 공식 인증 대리점 특가몰">
    <meta property="og:description" content="최신폰 특가, 인터넷+TV 최대 혜택! 공식 인증 대리점에서 안전하게 상담받으세요.">
    <meta property="og:image" content="https://i.ibb.co/LDYWCm5t/lgo.jpg">
    <meta property="og:url" content="https://ktmallstore.co.kr/">

    <!-- [Google Ads] 태그 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17795387426"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'AW-17795387426');
    </script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        fadeInUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        scaleUp: { '0%': { opacity: '0', transform: 'scale(0.95)' }, '100%': { opacity: '1', transform: 'scale(1)' } }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out',
                        'fade-in-up': 'fadeInUp 0.6s ease-out forwards',
                        'scale-up': 'scaleUp 0.3s ease-out forwards',
                    }
                }
            }
        }
    </script>

    <style>
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        /* ================================================================
           [관리자 설정 영역]
           ================================================================
        */
        const SITE_CONFIG = {
          email: {
            publicKey: "8xONgUdC9c0JycduK",
            serviceId: "service_paxmkkl",
            templateId: "template_x37d4fg",
            managerEmail: "ktgaurient@gmail.com"
          },
          info: {
            logoImg: "https://i.ibb.co/LDYWCm5t/lgo.jpg",
            phone: "010-2141-0137",
            kakaoUrl: "http://pf.kakao.com/_xjVcQn/chat",
            promotionText: "가전구독 프로모션 혜택상담 (선택사항)",
            topBannerText: "공식 온라인 대리점 인증",
            mainPriceLabel: "실구매가",
            ktCertImg: "https://i.ibb.co/S708ZYmS/gauri.png",
            ftcLogo: "https://i.ibb.co/21jL6FJj/gongjung.png",
            ftcLink: "https://www.ftc.go.kr/www/index.do",
            companyName: "(주)KT 가우리엔터프라이즈",
            representative: "현재훈",
            businessNumber: "876-88-01684",
            address: "대전광역시 동구 동서대로 1679, 106호",
            telecomNumber: "2025-대전동구-0571",
            privacyManager: "박범훈",
            kaitLogoHtml: `<img src="https://ictmarket.or.kr:8443/getCertIcon.do?cert_icon=AGT0000225826FA00331" style="cursor: pointer; height: 48px;" onclick="window.open('https://ictmarket.or.kr:8443/agent/pop_AgentCertIcon.do?AGENT_REQ_ID=AGT0000225826&AGENT_CD=FA00331','_blank','width=600, height=400, toolbar=no, menubar=no, scrollbars=no, resizable=no' )"/>` 
          },
          mainPopup: {
            isActive: true,
            badge: "공식 온라인 대리점 인증",
            title: "KT공식 인증 대리점 특가몰",
            btnText: "혜택 자세히 보기"
          },
          options: {
             insurance: [
                { name: '미가입', price: 0 },
                { name: '파손형 가입', price: 5900 }, 
                { name: '일반(분실포함) 가입', price: 6500 } 
             ],
             cards: [
                { name: '미신청', discount: 0 },
                { name: '우리카드 (전월 40만원 / 25,000원 할인) - 6개월 무실적', discount: 25000 },
                { name: '신한카드 (전월 30만원 / 21,000원 할인) - 6개월 무실적', discount: 21000 },
                { name: '국민카드 (전월 30만원 / 21,000원 할인) - 6개월 무실적', discount: 21000 },
                { name: '삼성카드 (전월 30만원 / 20,000원 할인) - 6개월 무실적', discount: 20000 },
                { name: '현대카드 (전월 50만원 / 26,000원 할인) - 6개월 무실적', discount: 26000 },
                { name: '롯데카드 (전월 30만원 / 22,000원 할인) - 6개월 무실적', discount: 22000 }
             ],
             packs: [
                { name: '미가입', price: 0 },
                { name: '가입', price: 0 } 
             ],
             combinations: [
                { name: '미결합', discount: 0, type: 'fixed' },
                { name: '프리미엄 싱글결합 (25% 요금할인)', discount: 0.25, type: 'percent' },
                { name: '프리미엄 가족결합 (25% 요금할인)', discount: 0.25, type: 'percent' },
                { name: '총액 결합할인 (기여도별 상이)', discount: 0, type: 'total' }, // 기여도별 계산 로직 사용
                { name: '우리가족 무선결합', discount: 3300, type: 'fixed' } 
             ]
          },
          banner: {
            images: [
              { pcImg: "https://i.ibb.co/cSfpwWpK/pc1.jpg", mobileImg: "https://i.ibb.co/R4SBrLBc/m1.jpg" },
              { pcImg: "https://i.ibb.co/wFXxR6mT/pc2.jpg", mobileImg: "https://i.ibb.co/Z6r6VZz3/m2.png" },
              { pcImg: "https://i.ibb.co/WWHNJMZV/pc3.jpg", mobileImg: "https://i.ibb.co/h1Mb2bCh/m3.png" },
              { pcImg: "https://i.ibb.co/hJkssTg7/pc4.jpg", mobileImg: "https://i.ibb.co/C3CHzKxk/m4.jpg" },
              { pcImg: "https://i.ibb.co/XfbqhSHr/pc5.jpg", mobileImg: "https://i.ibb.co/bgpnW45F/m5.png" }
            ]
          }, // <= Fixed missing comma
          preOrder: {
            isActive: true,
            badge: "COMING SOON",
            title: "사전예약 준비중",
            description: "출시 예정인 최신 모델을 가장 먼저 만나보세요.<br/>알림 신청을 하시면 오픈 즉시 문자로 알려드립니다.",
            models: ['Galaxy S26 Ultra', 'Galaxy S26', 'Z Fold 8', 'Z Flip 8']
          },
          
          specialProducts: [
            // 1. 아이폰 17 기본형
            { 
              id: 'ip17', 
              category: 'APPLE', 
              name: '아이폰 17 기본형', 
              img: 'https://i.ibb.co/23w8Wch4/aip17.png', 
              tag: '신상 특가', 
              isHot: true, 
              capacity: ['256GB', '512GB'], 
              prices: { '256GB': 1287000, '512GB': 1584000 }, 
              colors: [
                {name:'라벤더', code:'#E6E6FA'}, 
                {name:'세이지', code:'#9C9F84'}, 
                {name:'블랙', code:'#000000'}, 
                {name:'화이트', code:'#F5F5F5'}, 
                {name:'블루', code:'#A7C7E7'}
              ], 
              mandatoryPlan: '초이스 베이직(9만)', 
              publicSupport: 550000, 
              addSupport: 200000 
            },
            
            // 2. 아이폰 17 AIR
            { 
              id: 'ip17air', 
              category: 'APPLE', 
              name: '아이폰 17 AIR', 
              img: 'https://i.ibb.co/2TrS7Gd/aipairnk.png', 
              tag: '초슬림 디자인', 
              isHot: true, 
              capacity: ['256GB', '512GB'], 
              prices: { '256GB': 1584000, '512GB': 1881000 }, 
              colors: [
                {name:'블루', code:'#A7C7E7'}, 
                {name:'골드', code:'#E5D0AC'}, 
                {name:'화이트', code:'#F5F5F5'}, 
                {name:'블랙', code:'#000000'}
              ], 
              mandatoryPlan: '초이스 베이직(9만)', 
              publicSupport: 550000, 
              addSupport: 200000 
            },

            // 3. 아이폰 17 PRO
            { 
              id: 'ip17pro', 
              category: 'APPLE', 
              name: '아이폰 17 PRO', 
              img: 'https://i.ibb.co/fVGqkF58/aip17pnk.png', 
              tag: '강화바디', 
              isHot: true, 
              capacity: ['256GB', '512GB'], 
              prices: { '256GB': 1782000, '512GB': 2090000 }, 
              colors: [
                {name:'실버', code:'#C0C0C0'}, 
                {name:'블루', code:'#4B6EAF'}, 
                {name:'오렌지', code:'#FF8C00'}
              ], 
              mandatoryPlan: '초이스 베이직(9만)', 
              publicSupport: 550000, 
              addSupport: 200000 
            },

            // 4. 아이폰 17 PRO MAX
            { 
              id: 'ip17promax', 
              category: 'APPLE', 
              name: '아이폰 17 PRO MAX', 
              img: 'https://i.ibb.co/QjNcQv1r/aip17pmnk.png', 
              tag: '대화면', 
              isHot: true, 
              capacity: ['256GB', '512GB'], 
              prices: { '256GB': 1980000, '512GB': 2288000 }, 
              colors: [
                {name:'실버', code:'#C0C0C0'}, 
                {name:'블루', code:'#4B6EAF'}, 
                {name:'오렌지', code:'#FF8C00'}
              ], 
              mandatoryPlan: '초이스 베이직(9만)', 
              publicSupport: 201000, 
              addSupport: 200000 
            },

            // 5. 갤럭시 S25
            { 
              id: 's25', 
              category: 'SAMSUNG', 
              name: '갤럭시 S25', 
              img: 'https://i.ibb.co/6cTRN0Fs/s931n.png', 
              tag: 'AI폰의 정석', 
              isHot: true, 
              capacity: ['256GB', '512GB'], 
              prices: { '256GB': 1155000, '512GB': 1298000 }, 
              colors: [
                {name:'실버쉐도우', code:'#B0B3B8'}, 
                {name:'아이스블루', code:'#A0D3E8'}, 
                {name:'네이비', code:'#000080'}, 
                {name:'민트', code:'#98FF98'}
              ], 
              mandatoryPlan: '초이스 베이직(9만)', 
              publicSupport: 600000, 
              addSupport: 350000 
            },

            // 6. 갤럭시 Z Flip 7
            { 
              id: 'zflip7', 
              category: 'SAMSUNG', 
              name: '갤럭시 Z Flip 7', 
              img: 'https://i.ibb.co/qMBthvT6/f766n.png', 
              tag: '플립폰 대세', 
              isHot: true, 
              capacity: ['256GB', '512GB'], 
              prices: { '256GB': 1485000, '512GB': 1643400 }, 
              colors: [
                {name:'블루쉐도우', code:'#5D76A9'}, 
                {name:'코랄레드', code:'#FF6F61'}, 
                {name:'제트블랙', code:'#0A0A0A'}
              ], 
              mandatoryPlan: '초이스 베이직(9만)', 
              publicSupport: 600000, 
              addSupport: 350000 
            },

            // 7. 갤럭시 Z Fold 7
            { 
              id: 'zfold7', 
              category: 'SAMSUNG', 
              name: '갤럭시 Z Fold 7', 
              img: 'https://i.ibb.co/7tqtN4GQ/f966n.png', 
              tag: '멀티태스킹', 
              isHot: false, 
              capacity: ['256GB', '512GB'], 
              prices: { '256GB': 2379300, '512GB': 2537700 }, 
              colors: [
                {name:'블루쉐도우', code:'#5D76A9'}, 
                {name:'실버쉐도우', code:'#B0B3B8'}, 
                {name:'제트블랙', code:'#0A0A0A'}
              ], 
              mandatoryPlan: '초이스 베이직(9만)', 
              publicSupport: 600000, 
              addSupport: 350000 
            },

            // 8. 갤럭시 Jump 4
            { 
              id: 'jump4', 
              category: 'SAMSUNG', 
              name: '갤럭시 Jump 4', 
              img: 'https://i.ibb.co/mFJ7mmbq/zump4.png', 
              tag: '가성비 추천', 
              isHot: false, 
              capacity: ['128GB'], 
              prices: { '128GB': 449900 }, 
              colors: [
                {name:'블랙', code:'#000000'}, 
                {name:'라이트그린', code:'#90EE90'}
              ], 
              mandatoryPlan: '심플(6.1만)', 
              publicSupport: 392000, 
              addSupport: 86900 
            },

            // 9. 갤럭시 A17
            { 
              id: 'a17', 
              category: 'SAMSUNG', 
              name: '갤럭시 A17 (LTE)', 
              img: 'https://i.ibb.co/JRgsCsNG/a175nk.png', 
              tag: '효도폰/학생폰', 
              isHot: false, 
              capacity: ['128GB'], 
              prices: { '128GB': 319000 }, 
              colors: [
                {name:'블랙', code:'#000000'}, 
                {name:'그레이', code:'#808080'}, 
                {name:'라이트블루', code:'#ADD8E6'}
              ], 
              mandatoryPlan: 'LTE 3.7만(신규)', 
              publicSupport: 278000, 
              addSupport: 108000 
            }
          ],
          
          internet: {
            cards: [
              { id: 'plan1', name: "지니 TV 베이직", desc: "230여개 채널", badge: "" },
              { id: 'plan2', name: "지니 TV 모든G", desc: "250여개 채널+VOD", badge: "강력추천" },
              { id: 'plan3', name: "지니 TV 디즈니+", desc: "디즈니+ OTT 결합", badge: "" }
            ],
            prices: {
              '100M': { 
                  'genieA': { plan1: ['37,400원','31,900원'], plan2: ['42,900원','37,400원'], plan3: ['45,200원','39,700원'] },
                  'genie3A': { plan1: ['38,500원','33,000원'], plan2: ['44,000원','38,500원'], plan3: ['46,300원','40,800원'] },
                  'genie4': { plan1: ['40,700원','35,200원'], plan2: ['46,200원','40,700원'], plan3: ['48,500원','43,000원'] },
                  'sound': { plan1: ['42,900원','37,400원'], plan2: ['46,200원','40,700원'], plan3: ['48,500원','43,000원'] }
              },
              '500M': { 
                  'genieA': { plan1: ['42,900원','37,400원'], plan2: ['48,400원','42,900원'], plan3: ['50,700원','45,200원'] },
                  'genie3A': { plan1: ['44,000원','38,500원'], plan2: ['49,500원','44,000원'], plan3: ['51,800원','46,300원'] },
                  'genie4': { plan1: ['46,200원','40,700원'], plan2: ['51,700원','46,200원'], plan3: ['54,000원','48,500원'] },
                  'sound': { plan1: ['48,400원','42,900원'], plan2: ['51,700원','46,200원'], plan3: ['54,000원','48,500원'] }
              },
              '1G': { 
                  'genieA': { plan1: ['48,400원','42,900원'], plan2: ['53,900원','48,400원'], plan3: ['56,200원','50,700원'] },
                  'genie3A': { plan1: ['49,500원','44,000원'], plan2: ['55,000원','49,500원'], plan3: ['57,300원','51,800원'] },
                  'genie4': { plan1: ['51,700원','46,200원'], plan2: ['57,200원','51,700원'], plan3: ['59,500원','54,000원'] },
                  'sound': { plan1: ['53,900원','48,400원'], plan2: ['57,200원','51,700원'], plan3: ['59,500원','54,000원'] }
              }
            }
          },
          // 실시간 고객 후기 (관리자 설정)
          reviews: [
            { id: 1, user: '김*수', device: '갤럭시 S25', rating: 5, content: '신제품 사전예약으로 빠르게 받았습니다. 상담도 친절하고 사은품도 챙겨주셔서 감사합니다!', date: '2025.03.15', img: 'https://i.ibb.co/Y4Tt24rV/re-s831.jpg' },
            { id: 2, user: '이*영', device: '아이폰 17 PRO', rating: 5, content: '다른 곳보다 지원금이 확실히 많네요. 티타늄 컬러 너무 예쁩니다.', date: '2025.10.14', img: '' },
            { id: 3, user: '박*민', device: '갤럭시 Jump 4', rating: 4, content: '학생 폰으로 가성비 최고네요. 요금제도 저렴하게 잘 맞췄습니다.', date: '2025.09.12', img: 'https://i.ibb.co/3mgQrgMp/re-m366.jpg' },
            { id: 4, user: '최*호', device: 'Z Flip 7', rating: 5, content: '디자인이 너무 예뻐요. 배송도 하루만에 왔습니다.', date: '2025.09.11', img: 'https://i.ibb.co/FL8xTVtW/re-f766.jpg' },
            { id: 5, user: '정*아', device: '인터넷+TV', rating: 5, content: '결합할인 받아서 통신비가 많이 줄었어요.', date: '2025.03.10', img: '' },
            { id: 6, user: '강*우', device: '아이폰 17', rating: 4, content: '상담원이 친절하게 설명해주셔서 좋았습니다.', date: '2025.10.09', img: '' },
            { id: 7, user: '조*현', device: '갤럭시 S25', rating: 5, content: '역시 화면이 시원시원하네요. 대만족입니다.', date: '2025.03.08', img: '' },
            { id: 8, user: '윤*비', device: 'Z Fold 7', rating: 5, content: '업무용으로 샀는데 멀티태스킹이 편해요.', date: '2025.09.28', img: 'https://i.ibb.co/m5VsfLDR/re-f966.jpg' },
            { id: 9, user: '장*석', device: '갤럭시 A17', rating: 4, content: '부모님 효도폰으로 해드렸는데 좋아하시네요.', date: '2025.11.06', img: '' },
            { id: 10, user: '임*희', device: '아이폰 17 AIR', rating: 5, content: '가볍고 얇아서 들고 다니기 편해요.', date: '2025.11.05', img: '' },
            { id: 11, user: '한*민', device: '아이폰 17 PRO MAX', rating: 5, content: '화면 크고 배터리 오래가서 너무 좋아요.', date: '2025.11.04', img: 'https://i.ibb.co/C5xdBFmh/re-aip17pm.jpg' },
            { id: 12, user: '오*진', device: '갤럭시 S25', rating: 5, content: '색상이 실물이 훨씬 깡패네요.', date: '2025.05.03', img: '' },
            { id: 13, user: '신*우', device: 'Z Flip 7', rating: 4, content: '접히는게 신기하고 편해요. 주름도 많이 개선되었네요.', date: '2025.10.02', img: '' },
            { id: 14, user: '장*라', device: 'Z Flip 7', rating: 4, content: '접히는게 신기하고 편하다며 신기해하던 고객님이신데 "너무 친절하고 꼼꼼하게 잘해주셔서 고맙다며" 주신 간식', date: '2025.12.26', img: 'https://i.ibb.co/8nQbs4Yj/review01.jpg' }
          ]
        };

        const PLANS = [
          { id: 1, name: '초이스 스페셜', price: 110000, data: '완전무제한+VVIP' },
          { id: 2, name: '초이스 베이직', price: 90000, data: '완전무제한' },
          { id: 3, name: '심플', price: 61000, data: '30GB+5Mbps' },
          { id: 4, name: '시니어 베이직', price: 49000, data: '15GB+1Mbps' }, 
          { id: 5, name: 'Y틴', price: 48000, data: '10GB+1Mbps' },
          { id: 6, name: 'LTE 베이직', price: 37000, data: '2GB' },
        ];

        // [ICONS]
        const IconChevronRight = ({ className, size=24 }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="9 18 15 12 9 6"/></svg>
        );
        const IconStar = ({ className, size=24, fill="none" }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
        );
        const IconMenu = ({ className, size=24 }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
        );
        const IconSearch = ({ className, size=24 }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="11" cy="11" r="8"/><line x1="21" x2="16.65" y1="21" y2="16.65"/></svg>
        );
        const IconArrowLeft = ({ className, size=24 }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="19" x2="5" y1="12" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
        );
        const IconX = ({ className, size=24 }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M18 6 6 18"/><path d="M6 6 18 18"/></svg>
        );
        const IconTruck = ({ className, size=24 }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="1" height="1" x="1" y="1" fillOpacity="0"/><rect x="1" y="3" width="15" height="13" rx="2" ry="2"/><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/></svg>
        );
        const IconPhone = ({ className, size=24 }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
        );
        const IconMessage = ({ className, size=24 }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"/></svg>
        );
        const IconMonitor = ({ className, size=24 }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="20" height="14" x="2" y="3" rx="2" ry="2"/><line x1="8" x2="16" y1="21" y2="21"/><line x1="12" x2="12" y1="17" y2="21"/></svg>
        );
        const IconWifi = ({ className, size=24 }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><line x1="12" x2="12.01" y1="20" y2="20"/></svg>
        );
        const IconSmartphone = ({ className, size=24 }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></svg>
        );
        const IconSettings = ({ className, size=24 }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
        );

        // --- [HomePage] ---
        const HomePage = ({ siteConfig, plans, reviews, onProductClick, showPreOrderModal, setShowPreOrderModal }) => {
          const [currentBanner, setCurrentBanner] = useState(0);
          const [internetSpeed, setInternetSpeed] = useState('100M');
          const [internetStb, setInternetStb] = useState('genieA');
          const [showBannerBox, setShowBannerBox] = useState(siteConfig.mainPopup.isActive);
          const [reviewIndex, setReviewIndex] = useState(0);
          
          const [consultForm, setConsultForm] = useState({
            name: '', phone: '010', phoneBody: '',
            interests: { internet: true, mobile: false },
            mobileModel: '', netSpeed: '100M', tvCount: '베이직', settop: '기가지니A', combine: '미결합', promo: false
          });

          useEffect(() => {
            if (!siteConfig.banner.images.length) return;
            const timer = setInterval(() => {
              setCurrentBanner(prev => (prev + 1) % siteConfig.banner.images.length);
            }, 3000);
            return () => clearInterval(timer);
          }, [siteConfig.banner.images]);

          useEffect(() => {
            if (!reviews || !reviews.length) return;
            const timer = setInterval(() => {
              setReviewIndex((prev) => (prev + 1) % reviews.length);
            }, 2000);
            return () => clearInterval(timer);
          }, [reviews]);

          const currentReviews = useMemo(() => {
            if (!reviews || !reviews.length) return [];
            const result = [];
            for (let i = 0; i < 4; i++) {
              result.push(reviews[(reviewIndex + i) % reviews.length]);
            }
            return result;
          }, [reviewIndex, reviews]);

          const getInternetPrice = (planId) => {
            const speedData = siteConfig.internet.prices[internetSpeed];
            if (!speedData) return ['0원', '0원'];
            const stbData = speedData[internetStb];
            if (!stbData) return ['0원', '0원'];
            return stbData[planId] || ['0원', '0원'];
          };

          const toggleInterest = (type) => {
            setConsultForm(prev => ({
              ...prev,
              interests: { ...prev.interests, [type]: !prev.interests[type] }
            }));
          };

          const handleConsultSubmit = (e) => {
            e.preventDefault();
            if (!window.emailjs) { alert('메일 서버 연결 중입니다. 잠시 후 다시 시도해주세요.'); return; }
            const { internet, mobile } = consultForm.interests;
            if (!internet && !mobile) { alert('최소 하나의 관심 상품을 선택해주세요.'); return; }
            let details = [];
            if (internet) details.push(`[인터넷+TV] 속도:${consultForm.netSpeed}, TV:${consultForm.tvCount}, 셋탑:${consultForm.settop}, 결합:${consultForm.combine}`);
            if (mobile) details.push(`[휴대폰] 희망기종:${consultForm.mobileModel || '미입력'}`);
            details.push(`[프로모션동의] ${consultForm.promo ? '동의' : '미동의'}`);
            const params = {
              name: consultForm.name,
              phone: `${consultForm.phone}-${consultForm.phoneBody}`,
              branch: '빠른상담신청',
              promo_item: details.join('\n'),
              date: new Date().toLocaleString(),
              manager_email: siteConfig.email.managerEmail
            };
            window.emailjs.send(siteConfig.email.serviceId, siteConfig.email.templateId, params)
              .then(() => { alert('상담 신청이 완료되었습니다! 빠르게 연락드리겠습니다.'); setConsultForm(prev => ({...prev, name: '', phoneBody: ''})); })
              .catch(err => alert('전송 실패: ' + JSON.stringify(err)));
          };

          const calcRealPrice = (prod) => {
            if (!prod.prices || Object.keys(prod.prices).length === 0) return "가격문의";
            const basePrice = Object.values(prod.prices)[0]; 
            const totalSupport = prod.publicSupport + prod.addSupport;
            const finalPrice = Math.max(0, basePrice - totalSupport);
            if (finalPrice === 0) return "0원 (전액지원)";
            return `${finalPrice.toLocaleString()}원`;
          };

          // [NEW] 메인화면용 최저가 계산기 (모델별 기준 요금제 적용)
          const calcBestPriceInfo = (prod) => {
            if (!prod.prices || Object.keys(prod.prices).length === 0) return { price: "가격문의", label: "" };
            
            // 1. 기기값 (첫번째 용량 기준)
            const devicePrice = Object.values(prod.prices)[0]; 
            
            // 2. 기준 요금제 설정 (모델별 상이)
            let planFee = 90000; // 기본 9만원
            if (prod.id === 'jump4') planFee = 61000; // Jump4는 6.1만 기준
            else if (prod.id === 'a17') planFee = 37000; // A17은 3.7만 기준

            // 3. 혜택 비교
            // A. 공통지원금 혜택 (공시+추가)
            // A17의 경우 메인 화면에서는 '최대 혜택'을 보여주기 위해 신규가입(추가지원금 포함) 기준으로 계산
            const subsidyBenefit = prod.publicSupport + prod.addSupport;
            
            // B. 선택약정 혜택 (요금할인 25% * 24개월 + 추가지원금)
            const contractTotalDiscount = (planFee * 0.25 * 24) + prod.addSupport;

            // 3. 더 큰 혜택 적용하여 실구매가 계산
            let finalPrice = 0;
            let label = "";

            if (contractTotalDiscount > subsidyBenefit) {
                // 선택약정이 유리한 경우
                finalPrice = Math.max(0, devicePrice - contractTotalDiscount);
                label = "선택약정할인 기준";
            } else {
                // 공통지원금이 유리한 경우
                finalPrice = Math.max(0, devicePrice - subsidyBenefit);
                label = "공통지원금 기준";
            }
            
            return {
                price: finalPrice === 0 ? "0원" : `${finalPrice.toLocaleString()}원`,
                label: label
            };
          };

          const getPlanLabel = (id) => {
            if (id === 'jump4') return '(61요금제 기준)';
            if (id === 'a17') return '(37요금제 기준)';
            return '(90요금제 기준)';
          };

          return (
            <div className="pb-20 bg-gray-50 relative">
              <section className="relative w-full md:h-[500px] aspect-square md:aspect-auto bg-gray-900 overflow-hidden">
                {siteConfig.banner.images.map((img, idx) => (
                  <div key={idx} className={`absolute inset-0 w-full h-full transition-opacity duration-1000 ${currentBanner === idx ? 'opacity-100 z-10' : 'opacity-0 z-0'}`}>
                      <div className="absolute inset-0 w-full h-full overflow-hidden">
                        <img src={img.pcImg} className="hidden md:block w-full h-full object-cover blur-2xl opacity-50 scale-110" alt="" />
                        <img src={img.mobileImg} className="block md:hidden w-full h-full object-cover blur-2xl opacity-50 scale-110" alt="" />
                      </div>
                      <div className="absolute inset-0 flex items-center justify-center p-0">
                        <img src={img.pcImg} className="hidden md:block w-full h-full object-cover object-center drop-shadow-2xl" alt="Main Banner" />
                        <img src={img.mobileImg} className="block md:hidden w-full h-full object-cover object-center drop-shadow-2xl" alt="Main Banner" />
                      </div>
                      <div className="absolute inset-0 flex flex-col items-center justify-center text-center px-4 z-20 pointer-events-none">
                        {showBannerBox && (
                          <div className="bg-white/90 backdrop-blur-md p-6 md:p-10 rounded-3xl shadow-2xl animate-fade-in-up relative pointer-events-auto border border-white/50">
                              <button onClick={() => setShowBannerBox(false)} className="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors" aria-label="닫기"><IconX size={20} /></button>
                              <span className="inline-block px-3 py-1 border border-red-500 text-red-500 font-bold rounded-full text-xs mb-3">{siteConfig.mainPopup.badge}</span>
                              <h2 className="text-3xl md:text-5xl font-extrabold leading-tight text-gray-900 mb-4">{siteConfig.mainPopup.title}</h2>
                              <button onClick={() => document.getElementById('products')?.scrollIntoView({behavior:'smooth'})} className="bg-red-600 text-white px-8 py-3 rounded-full font-bold shadow-lg hover:bg-red-700 transition transform hover:scale-105">{siteConfig.mainPopup.btnText}</button>
                          </div>
                        )}
                      </div>
                  </div>
                ))}
              </section>

              <section className="max-w-7xl mx-auto px-4 py-16" id="products">
                <h3 className="text-2xl font-bold mb-8 text-gray-900 text-center md:text-left"><span className="text-red-600 mr-2">MD PICK</span>놓치면 후회하는 특가</h3>
                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                  {siteConfig.specialProducts.map((product) => {
                    const bestInfo = calcBestPriceInfo(product);
                    return (
                      <div key={product.id} onClick={() => onProductClick(product)} className="bg-white rounded-xl border border-gray-200 overflow-hidden hover:border-red-500 hover:shadow-xl transition-all duration-300 cursor-pointer group">
                        <div className="relative h-64 bg-gray-100 flex items-center justify-center p-6">
                          {product.isHot && <span className="absolute top-0 left-0 bg-red-600 text-white text-xs font-bold px-3 py-1.5 rounded-br-lg z-10">HOT</span>}
                          <img src={product.img} alt={product.name} className="h-full object-contain group-hover:scale-110 transition duration-300 drop-shadow-md" />
                        </div>
                        <div className="p-6">
                          <div className="flex gap-2 mb-2">
                            <span className="text-[10px] font-bold border border-gray-300 text-gray-500 px-1.5 py-0.5 rounded">{product.category}</span>
                            <span className="text-[10px] font-bold bg-red-50 text-red-600 px-1.5 py-0.5 rounded">{product.tag}</span>
                          </div>
                          <h4 className="text-lg font-bold mb-4 text-gray-900 truncate">{product.name}</h4>
                          <div className="border-t border-dashed border-gray-200 my-4"></div>
                          <div className="flex justify-between items-end">
                            <div className="flex flex-col">
                                <span className="text-gray-500 text-sm">{siteConfig.info.mainPriceLabel}</span>
                                <span className="text-[10px] text-blue-500 font-bold bg-blue-50 px-1 rounded inline-block w-fit mt-1">{bestInfo.label}</span>
                            </div>
                            <div className="text-right"><span className="text-xl font-extrabold text-red-600">{bestInfo.price}</span></div>
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </section>

              <section className="bg-white py-16 px-4 border-t border-gray-100" id="internet">
                 <div className="max-w-6xl mx-auto">
                    <div className="text-center mb-10"><span className="text-red-600 font-bold text-sm tracking-widest mb-2">INTERNET & TV</span><h2 className="text-3xl font-black text-gray-900">KT 인터넷 + TV 결합할인</h2></div>
                    <div className="bg-white rounded-3xl p-6 md:p-10 shadow-xl border border-gray-200">
                       <div className="flex flex-col md:flex-row justify-between items-center gap-6 mb-8 border-b border-gray-100 pb-8">
                          <div className="flex gap-2 bg-gray-100 p-1 rounded-xl">
                             {['100M', '500M', '1G'].map(speed => (
                                <button key={speed} onClick={() => setInternetSpeed(speed)} className={`px-4 py-2 rounded-lg text-sm font-bold transition ${internetSpeed === speed ? 'bg-white shadow text-red-600' : 'text-gray-500'}`}>{speed}</button>
                             ))}
                          </div>
                          <div className="flex items-center gap-2">
                             <span className="text-sm font-bold text-gray-600 flex items-center"><IconMonitor size={16} className="inline mr-1"/> 셋탑박스:</span>
                             <select className="bg-gray-50 border border-gray-200 rounded-lg p-2 text-sm font-bold outline-none" value={internetStb} onChange={e => setInternetStb(e.target.value)}>
                                <option value="genieA">기가지니A</option><option value="genie3A">기가지니3</option><option value="genie4">지니4</option><option value="sound">사운드바</option>
                             </select>
                          </div>
                       </div>
                       <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                          {siteConfig.internet.cards.map((card, idx) => {
                             const [org, sale] = getInternetPrice(`plan${idx+1}`);
                             return (
                                <div key={card.id} className={`border rounded-2xl p-6 transition hover:border-red-500 hover:shadow-lg ${card.badge ? 'border-red-200 bg-red-50/10' : 'border-gray-200 bg-white'}`}>
                                   {card.badge && <span className="inline-block bg-red-600 text-white text-[10px] px-2 py-0.5 rounded font-bold mb-2">{card.badge}</span>}
                                   <h3 className="font-bold text-lg text-gray-900">{card.name}</h3>
                                   <p className="text-xs text-gray-500 mb-4">{card.desc}</p>
                                   <div className="space-y-2 mb-4">
                                      <div className="flex justify-between text-xs text-gray-400 line-through"><span>기본료</span><span>{org}</span></div>
                                      <div className="flex justify-between items-end border-t border-gray-100 pt-3"><span className="font-bold text-gray-700">결합가</span><span className="text-2xl font-black text-red-600">{sale}</span></div>
                                   </div>
                                   <button onClick={() => { setConsultForm(prev => ({ ...prev, interests: { ...prev.interests, internet: true } })); document.getElementById('consult-form').scrollIntoView({ behavior: 'smooth' }); }} className="w-full bg-slate-900 text-white py-3 rounded-xl font-bold text-sm hover:bg-red-600 transition">신청하기</button>
                                </div>
                             );
                          })}
                       </div>
                    </div>
                 </div>
              </section>

              <section className="bg-gray-50 py-16 border-t border-gray-200">
                <div className="max-w-7xl mx-auto px-4">
                  <div className="flex justify-between items-end mb-8"><h3 className="text-2xl font-bold text-gray-900">실시간 개통 후기</h3><span className="text-sm text-gray-500 animate-pulse">● 실시간 업데이트 중</span></div>
                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 transition-all duration-500 ease-in-out">
                    {currentReviews.map((review, idx) => (
                      <div key={`${review.id}-${idx}`} className="bg-white p-6 rounded-xl border border-gray-100 shadow-sm animate-fade-in hover:shadow-md transition h-full flex flex-col">
                        {review.img && (
                          <div className="mb-4 rounded-lg overflow-hidden h-52 w-full bg-gray-100 border border-gray-200 relative group">
                             <div className="absolute inset-0 w-full h-full bg-cover bg-center blur-lg opacity-60 transition-transform duration-500 group-hover:scale-110" style={{ backgroundImage: `url(${review.img})` }}></div>
                             <img src={review.img} alt="review" className="relative w-full h-full object-contain z-10 transition-transform duration-300 group-hover:scale-105" />
                          </div>
                        )}
                        <div className="flex justify-between items-start mb-4">
                          <div className="overflow-hidden">
                            <div className="font-bold text-gray-900 truncate">{review.device}</div>
                            <div className="text-xs text-gray-500">{review.user}님 | {review.date}</div>
                          </div>
                          <div className="flex text-amber-400 flex-shrink-0">
                            {[...Array(review.rating)].map((_, j) => <IconStar key={j} size={14} fill="currentColor" />)}
                          </div>
                        </div>
                        <p className="text-gray-600 text-sm line-clamp-2 h-10">"{review.content}"</p>
                      </div>
                    ))}
                  </div>
                </div>
              </section>

              <section id="consult-form" className="bg-gradient-to-b from-white to-gray-50 py-20 px-4">
                 <div className="max-w-lg mx-auto bg-white rounded-3xl shadow-2xl p-8 border border-gray-100">
                    <div className="text-center mb-8"><span className="bg-red-100 text-red-600 text-xs font-bold px-3 py-1 rounded-full mb-3 inline-block">빠른 상담</span><h3 className="text-2xl font-bold mb-2 text-gray-900">궁금한 점이 있으신가요?</h3><p className="text-gray-500 text-sm">원하시는 상품을 선택(중복 가능)하시면 자세히 안내해 드립니다.</p></div>
                    <form onSubmit={handleConsultSubmit} className="space-y-6">
                       <div className="flex gap-3">
                          <button type="button" onClick={() => toggleInterest('internet')} className={`flex-1 py-4 rounded-xl text-sm font-bold transition border-2 ${consultForm.interests.internet ? 'bg-red-50 border-red-500 text-red-600' : 'bg-gray-50 border-transparent text-gray-400 hover:bg-gray-100'}`}><IconWifi className={`w-5 h-5 mx-auto mb-1 ${consultForm.interests.internet ? 'text-red-500' : 'text-gray-400'}`}/> 인터넷+TV</button>
                          <button type="button" onClick={() => toggleInterest('mobile')} className={`flex-1 py-4 rounded-xl text-sm font-bold transition border-2 ${consultForm.interests.mobile ? 'bg-red-50 border-red-500 text-red-600' : 'bg-gray-50 border-transparent text-gray-400 hover:bg-gray-100'}`}><IconSmartphone className={`w-5 h-5 mx-auto mb-1 ${consultForm.interests.mobile ? 'text-red-500' : 'text-gray-400'}`}/> 휴대폰</button>
                       </div>
                       <div className="space-y-4">
                         <div className="space-y-2">
                           <input type="text" required placeholder="이름" className="w-full bg-white border border-gray-200 rounded-xl p-3 text-gray-900 focus:border-red-500 outline-none transition-all text-sm" value={consultForm.name} onChange={e => setConsultForm({...consultForm, name: e.target.value})} />
                           <div className="flex gap-2">
                              <select className="bg-white border border-gray-200 rounded-xl p-3 text-gray-900 outline-none w-24 focus:border-red-500 text-sm" value={consultForm.phone} onChange={e => setConsultForm({...consultForm, phone: e.target.value})}><option>010</option><option>011</option></select>
                              <input type="tel" required placeholder="1234-5678" className="flex-1 bg-white border border-gray-200 rounded-xl p-3 text-gray-900 focus:border-red-500 outline-none transition-all text-sm" value={consultForm.phoneBody} onChange={e => setConsultForm({...consultForm, phoneBody: e.target.value})} />
                           </div>
                         </div>
                         {consultForm.interests.internet && (
                           <div className="bg-slate-50 p-4 rounded-xl border border-slate-100 space-y-3 animate-fade-in">
                             <p className="text-xs font-bold text-slate-500 mb-1">인터넷+TV 상담 옵션</p>
                             <div className="grid grid-cols-2 gap-2">
                               <select className="w-full bg-white border border-gray-200 rounded-lg p-3 text-sm" value={consultForm.netSpeed} onChange={e => setConsultForm({...consultForm, netSpeed: e.target.value})}><option value="100M">100M (슬림)</option><option value="500M">500M (베이직)</option><option value="1G">1G (에센스)</option></select>
                               <select className="w-full bg-white border border-gray-200 rounded-lg p-3 text-sm" value={consultForm.tvCount} onChange={e => setConsultForm({...consultForm, tvCount: e.target.value})}><option value="베이직">베이직</option><option value="지니 TV 모든G">지니 TV 모든G</option><option value="지니 TV 디즈니+">지니 TV 디즈니+</option></select>
                             </div>
                             <div className="grid grid-cols-2 gap-2">
                                <select className="w-full bg-white border border-gray-200 rounded-lg p-3 text-sm" value={consultForm.settop} onChange={e => setConsultForm({...consultForm, settop: e.target.value})}><option value="기가지니A">기가지니A</option><option value="기가지니3">기가지니3</option><option value="지니4">지니4</option><option value="사운드바">사운드바</option></select>
                                <select className="w-full bg-white border border-gray-200 rounded-lg p-3 text-sm" value={consultForm.combine} onChange={e => setConsultForm({...consultForm, combine: e.target.value})}><option value="미결합">휴대폰 결합 없음</option><option value="결합(1회선)">휴대폰 결합 (1회선)</option><option value="결합(2회선 이상)">휴대폰 결합 (2회선 이상)</option></select>
                             </div>
                           </div>
                         )}
                         {consultForm.interests.mobile && (
                           <div className="bg-slate-50 p-4 rounded-xl border border-slate-100 animate-fade-in">
                             <p className="text-xs font-bold text-slate-500 mb-2">휴대폰 상담 옵션</p>
                             <input type="text" placeholder="상담 받을 기종 (예: 아이폰17)" className="w-full bg-white border border-gray-200 rounded-lg p-3 text-sm outline-none focus:border-red-500" value={consultForm.mobileModel} onChange={e => setConsultForm({...consultForm, mobileModel: e.target.value})} />
                           </div>
                         )}
                       </div>
                       <div className="flex items-center gap-2 py-2">
                          <input type="checkbox" id="footer-promo" checked={consultForm.promo} onChange={e => setConsultForm({...consultForm, promo: e.target.checked})} className="w-5 h-5 rounded text-red-600 focus:ring-red-600 border-gray-300"/>
                          <label htmlFor="footer-promo" className="text-sm text-gray-500 cursor-pointer">{siteConfig.info.promotionText}</label>
                       </div>
                       <button type="submit" className="w-full bg-red-600 hover:bg-red-700 text-white py-4 rounded-xl font-bold text-lg transition shadow-lg shadow-red-200 transform active:scale-[0.98]">무료 상담 신청하기</button>
                    </form>
                 </div>
              </section>
            </div>
          );
        };

        const ProductDetailPage = ({ product, plans, siteConfig, onBack }) => {
          const [selectedCapacity, setSelectedCapacity] = useState(product.capacity[0]);
          const [selectedColor, setSelectedColor] = useState(product.colors[0]);
          const [installmentPeriod, setInstallmentPeriod] = useState(24);
          const [discountType, setDiscountType] = useState('subsidy'); 
          // [추가] 가입 유형 상태 (기본값: 기기변경)
          const [signupType, setSignupType] = useState('device_change'); 

          const [customerName, setCustomerName] = useState('');
          const [customerPhone, setCustomerPhone] = useState('');
          const [insurance, setInsurance] = useState(siteConfig.options.insurance[0]);
          const [cardApply, setCardApply] = useState(siteConfig.options.cards[0]);
          const [packApply, setPackApply] = useState(siteConfig.options.packs[0]);
          const [combination, setCombination] = useState(siteConfig.options.combinations[0]);
          const [familyFees, setFamilyFees] = useState(Array(7).fill(''));

          const availablePlans = useMemo(() => {
            if (product.id === 'jump4') return plans.filter(p => p.price === 61000);
            else if (product.id === 'a17') return plans.filter(p => p.price === 37000);
            else return plans.filter(p => p.price === 90000 || p.price === 110000);
          }, [product.id, plans]);

          const [selectedPlan, setSelectedPlan] = useState(availablePlans[0]); 
          const [calcResult, setCalcResult] = useState({ deviceCost: 0, monthlyDevice: 0, basePlanFee: 0, contractDiscount: 0, comboDiscount: 0, cardDiscount: 0, insuranceDiscount: 0, totalMonthly: 0, finalPublicSupport: 0, finalAddSupport: 0 });

          useEffect(() => {
            if(availablePlans.length > 0) setSelectedPlan(availablePlans[0]);
          }, [product, availablePlans]);
          
          useEffect(() => {
            if(availablePlans.length > 0) {
                const defaultPlan = availablePlans.find(p => p.price === 90000) || availablePlans[0];
                setSelectedPlan(defaultPlan);
            }
          }, [product, availablePlans]);

          // 가족 요금 합계 계산 헬퍼 함수
          const getFamilyFeeSum = () => {
            return familyFees.reduce((sum, fee) => sum + (Number(fee) || 0), 0);
          };

          // 할인 비교 계산 (2년 총 혜택)
          const compareDiscounts = useMemo(() => {
             if (!selectedPlan) return { subsidy: 0, contract: 0 };
             
             // [수정] A17 모델은 신규가입일 때만 추가지원금 포함 비교
             let addSupportBenefit = product.addSupport;
             if (product.id === 'a17' && signupType !== 'new_signup') {
                 addSupportBenefit = 0;
             }

             // 1. 공통지원금 방식 총 혜택: 공통지원금 + 추가지원금
             const subsidyBenefit = product.publicSupport + addSupportBenefit;
             
             // 2. 선택약정 방식 총 혜택: (요금할인 25% * 24개월) + 추가지원금
             const monthlyContractDiscount = Math.floor(selectedPlan.price * 0.25);
             const contractBenefit = (monthlyContractDiscount * 24) + addSupportBenefit;

             return { subsidy: subsidyBenefit, contract: contractBenefit };
          }, [selectedPlan, product, signupType]);

          useEffect(() => {
            if(!selectedPlan) return;
            const prices = product.prices || {};
            let devicePrice = prices[selectedCapacity] || Object.values(prices)[0] || 0;
            
            let appliedSubsidy = 0;
            let currentPublicSupport = 0;
            let currentAddSupport = 0;
            
            const basePlanFee = selectedPlan.price;
            let contractDiscount = 0;

            if (discountType === 'subsidy') {
              const isHighPlan = selectedPlan.price >= 90000;
              const isJumpCondition = product.id === 'jump4' && selectedPlan.price >= 61000;
              // [수정] A17 조건: 37요금제 이상 AND 신규가입(new_signup)일 때만 추가지원금 적용
              const isA17Condition = product.id === 'a17' && selectedPlan.price >= 37000 && signupType === 'new_signup';
              
              currentPublicSupport = product.publicSupport; 
              
              if (isHighPlan || isJumpCondition || isA17Condition) {
                  currentAddSupport = product.addSupport; 
              } else {
                  currentAddSupport = 0;
              }
              
              appliedSubsidy = currentPublicSupport + currentAddSupport;
            } else {
              contractDiscount = Math.floor(basePlanFee * 0.25); 
              // [수정] 선택약정 시에도 A17은 신규가입 조건 체크
              if (product.id === 'a17') {
                  currentAddSupport = (signupType === 'new_signup') ? product.addSupport : 0;
              } else {
                  currentAddSupport = product.addSupport;
              }
              appliedSubsidy = currentAddSupport; 
            }

            const finalDevicePrice = Math.max(0, devicePrice - appliedSubsidy);
            let monthlyDeviceCost = 0;
            if (finalDevicePrice > 0 && installmentPeriod > 0) {
                const annualRate = 0.059; 
                const monthlyRate = annualRate / 12;
                monthlyDeviceCost = Math.floor((finalDevicePrice * monthlyRate * Math.pow(1 + monthlyRate, installmentPeriod)) / (Math.pow(1 + monthlyRate, installmentPeriod) - 1));
                monthlyDeviceCost = Math.floor(monthlyDeviceCost / 10) * 10;
            }

            // 결합 할인 계산 로직 (총액 결합 기여도별 할인 - 정밀 계산)
            let comboDiscount = 0;
            if (combination.type === 'percent') {
              comboDiscount = Math.floor(basePlanFee * combination.discount); 
            } else if (combination.type === 'total') {
               // 총액 결합 할인 로직 (KT 인터넷 베이직 500M 기준)
               const familySum = getFamilyFeeSum();
               const totalMobileFee = basePlanFee + familySum;
               let totalDiscountAmount = 0;

               // 구간별 전체 모바일 할인액 설정 (500M 인터넷 기준)
               if (totalMobileFee < 64900) {
                   totalDiscountAmount = 0; 
               } else if (totalMobileFee < 108900) {
                   totalDiscountAmount = 5500;
               } else if (totalMobileFee < 141900) {
                   totalDiscountAmount = 16610;
               } else if (totalMobileFee < 174900) {
                   totalDiscountAmount = 22110;
               } else {
                   totalDiscountAmount = 27610;
               }

               // 내 기여도에 따른 할인액 계산 (내 요금 / 전체 요금)
               if (totalMobileFee > 0 && totalDiscountAmount > 0) {
                   comboDiscount = Math.floor((totalDiscountAmount * (basePlanFee / totalMobileFee)) / 10) * 10;
               }
            } else {
              comboDiscount = combination.discount;
            }

            const baseInsuranceFee = insurance.price || 0;
            let insuranceDiscount = 0;
            let insuranceDiscountMsg = "";
            if (selectedPlan.price >= 110000 && baseInsuranceFee > 0) {
                const discountAmount = 4500; 
                insuranceDiscount = Math.min(baseInsuranceFee, discountAmount); 
                insuranceDiscountMsg = "(VIP할인 적용)";
            }
            const finalInsuranceFee = Math.max(0, baseInsuranceFee - insuranceDiscount);

            let finalPlanFee = basePlanFee - contractDiscount - comboDiscount - cardApply.discount;
            finalPlanFee = Math.max(0, finalPlanFee); 

            const total = monthlyDeviceCost + finalPlanFee + finalInsuranceFee + (packApply.price || 0);

            setCalcResult({
              deviceCost: finalDevicePrice,
              monthlyDevice: monthlyDeviceCost,
              basePlanFee: basePlanFee,
              contractDiscount: contractDiscount,
              comboDiscount: comboDiscount,
              cardDiscount: cardApply.discount,
              insuranceDiscount: insuranceDiscount,
              totalMonthly: total,
              insuranceDiscountMsg: insuranceDiscountMsg,
              finalPublicSupport: currentPublicSupport,
              finalAddSupport: currentAddSupport
            });
          }, [selectedCapacity, installmentPeriod, discountType, selectedPlan, product, insurance, cardApply, packApply, combination, familyFees, signupType]);

          const handleFamilyFeeChange = (index, value) => {
            const newFees = [...familyFees];
            newFees[index] = value;
            setFamilyFees(newFees);
          };

          // 가입유형 한글 변환
          const getSignupTypeText = (type) => {
              if (type === 'new_signup') return '신규가입';
              if (type === 'number_portability') return '번호이동';
              return '기기변경';
          };

          const handleOrder = () => {
            if (!customerName || !customerPhone) { alert("상담 접수를 위해 이름과 연락처를 입력해주세요."); return; }
            if(window.emailjs) {
                const familySum = getFamilyFeeSum();
                const familyFeeDetails = familyFees.map((fee, i) => fee ? `가족${i+1}: ${fee}원` : '').filter(Boolean).join(', ');
                const params = {
                    name: customerName, phone: customerPhone, branch: '모바일주문',
                    promo_item: `[주문] ${product.name} / ${selectedCapacity} / ${selectedColor.name}\n[가입유형] ${getSignupTypeText(signupType)}\n[요금제] ${selectedPlan.name} (월 ${selectedPlan.price.toLocaleString()}원)\n[조건] ${installmentPeriod}개월 / ${discountType === 'subsidy' ? '공통지원' : '선택약정'}\n[추가옵션] \n- 보험: ${insurance.name}\n- 카드: ${cardApply.name}\n- 팩: ${packApply.name}\n- 결합: ${combination.name} (가족합산: ${familySum}원 [${familyFeeDetails}])\n[할인내역]\n- 약정할인: ${calcResult.contractDiscount}원\n- 결합할인: ${calcResult.comboDiscount}원\n- 카드할인: ${calcResult.cardDiscount}원\n- 보험할인: ${calcResult.insuranceDiscount}원\n[지원금] 공통: ${calcResult.finalPublicSupport}원 / 추가: ${calcResult.finalAddSupport}원\n[월납부] ${calcResult.totalMonthly.toLocaleString()}원 (5.9% 이자포함)`,
                    date: new Date().toLocaleString(),
                    manager_email: siteConfig.email.managerEmail
                };
                window.emailjs.send(siteConfig.email.serviceId, siteConfig.email.templateId, params).then(() => console.log("Email sent successfully")).catch(e => console.error("Email send failed:", e));
            }
            alert("이메일 상담 접수가 되었습니다.");
          }

          const handleKakaoConsult = () => {
             if (!customerName || !customerPhone) { alert("원활한 상담을 위해 이름과 연락처를 입력해주세요."); return; }
             const familySum = getFamilyFeeSum();
             const familyFeeDetails = familyFees.map((fee, i) => fee ? `가족${i+1}: ${fee}원` : '').filter(Boolean).join(', ');
             const textToCopy = `[KT 스토어 상담 신청]\n- 신청자: ${customerName}\n- 연락처: ${customerPhone}\n- 모델: ${product.name}\n- 용량: ${selectedCapacity}\n- 색상: ${selectedColor.name}\n- 가입유형: ${getSignupTypeText(signupType)}\n- 요금제: ${selectedPlan ? selectedPlan.name : '선택없음'}\n- 약정조건: ${installmentPeriod}개월 / ${discountType === 'subsidy' ? '공통지원금' : '선택약정'}\n- 추가옵션: \n  보험(${insurance.name}) \n  제휴카드(${cardApply.name}) \n  필수팩(${packApply.name})\n  결합할인(${combination.name})\n  (가족합산: ${familySum}원 [${familyFeeDetails}])\n- 월 예상 납부금: ${calcResult.totalMonthly.toLocaleString()}원 (할부이자 5.9% 포함)\n\n위 내용으로 상담 신청합니다.`;
             const textArea = document.createElement("textarea");
             textArea.value = textToCopy;
             textArea.style.position = "fixed"; textArea.style.left = "-9999px";
             document.body.appendChild(textArea);
             textArea.select();
             try { document.execCommand('copy'); alert("선택하신 모든 내용이 자동 복사되었습니다.\n채널창에 '붙여넣기'해서 상담 신청해주세요!"); } catch (err) { console.error('Copy failed', err); alert("자동 복사에 실패했습니다. 상담창에서 문의해주세요."); }
             document.body.removeChild(textArea);
             window.open(siteConfig.info.kakaoUrl, '_blank');
          };

          if (!selectedPlan) return <div>Loading...</div>;

          return (
            <div className="animate-fade-in bg-white min-h-screen pb-20">
              <div className="max-w-7xl mx-auto px-4 py-6">
                <button onClick={onBack} className="flex items-center text-gray-500 hover:text-red-600 mb-6 font-medium transition"><IconArrowLeft size={20} className="mr-2"/> 목록으로 돌아가기</button>
                <div className="flex flex-col lg:flex-row gap-12">
                  <div className="lg:w-1/2">
                      <div className="sticky top-24">
                        <div className="aspect-square bg-gray-50 rounded-2xl border border-gray-100 flex items-center justify-center p-8 relative">
                          <span className="absolute top-6 right-6 bg-red-600 text-white font-bold px-3 py-1 rounded-full text-sm">BEST</span>
                          <img src={product.img} alt={product.name} className="w-full h-full object-contain drop-shadow-2xl" />
                        </div>
                      </div>
                  </div>
                  <div className="lg:w-1/2">
                      <h2 className="text-3xl font-bold mb-2 text-gray-900">{product.name}</h2>
                      <div className="flex items-center gap-2 mb-8"><div className="flex text-amber-400">{[...Array(5)].map((_,i) => <IconStar key={i} fill="currentColor" size={18} />)}</div><span className="text-gray-500 text-sm font-medium">4.9 (284건 후기)</span></div>
                      <div className="space-y-8">
                        <div className="grid grid-cols-2 gap-4">
                            <div>
                              <label className="block text-sm font-bold mb-2 text-gray-800">용량</label>
                              <select className="w-full p-3 border border-gray-300 rounded-lg outline-none focus:border-red-500 font-bold" value={selectedCapacity} onChange={(e) => setSelectedCapacity(e.target.value)}>{product.capacity.map(c => <option key={c} value={c}>{c}</option>)}</select>
                            </div>
                            <div>
                              <label className="block text-sm font-bold mb-2 text-gray-800">색상</label>
                              <div className="flex gap-2 overflow-x-auto pb-2 items-center">{product.colors.map(c => (<button key={c.name} onClick={() => setSelectedColor(c)} className={`w-6 h-6 rounded-full border flex-shrink-0 transition-all duration-200 ${selectedColor.name === c.name ? 'ring-2 ring-red-500 ring-offset-2 scale-110 shadow-md border-transparent' : 'border-gray-300 hover:scale-110 hover:border-gray-400'}`} style={{ backgroundColor: c.code }} title={c.name} />))}</div>
                              <div className="text-xs text-gray-500 mt-1 font-medium">{selectedColor.name}</div>
                            </div>
                        </div>

                        {/* [NEW] 가입 유형 선택 */}
                        <div>
                          <label className="block text-sm font-bold mb-2 text-gray-800">가입 유형</label>
                          <div className="flex gap-2">
                              {['device_change', 'number_portability', 'new_signup'].map(type => (
                                  <button 
                                      key={type}
                                      onClick={() => setSignupType(type)}
                                      className={`flex-1 py-3 border rounded-lg text-sm font-medium transition ${signupType === type ? 'border-red-600 bg-red-50 text-red-700' : 'border-gray-300 text-gray-600'}`}
                                  >
                                      {type === 'device_change' ? '기기변경' : type === 'number_portability' ? '번호이동' : '신규가입'}
                                  </button>
                              ))}
                          </div>
                          {product.id === 'a17' && signupType !== 'new_signup' && (
                              <p className="text-[10px] text-red-500 mt-1">* 해당 모델은 신규가입 시에만 추가 지원금 혜택이 적용됩니다.</p>
                          )}
                        </div>

                        <div>
                            <label className="block text-sm font-bold mb-2 text-gray-800">요금제</label>
                            <select className={`w-full p-3 border border-gray-300 rounded-lg outline-none focus:border-red-500 font-medium ${availablePlans.length === 1 ? 'bg-gray-100 text-gray-500 cursor-not-allowed' : ''}`} onChange={(e) => setSelectedPlan(availablePlans.find(p => p.id === parseInt(e.target.value)))} value={selectedPlan?.id} disabled={availablePlans.length === 1}>{availablePlans.map(p => <option key={p.id} value={p.id}>{p.name} ({p.data}) - 월 {p.price.toLocaleString()}원</option>)}</select>
                            <p className="text-xs text-red-500 mt-1">* 9만원 요금제 유지 시 특가 지원금이 적용됩니다. (일부 모델 제외)</p>
                        </div>
                        <div className="bg-gray-50 p-5 rounded-xl border border-gray-100 space-y-4">
                            <div className="flex items-center gap-2 mb-2"><IconSettings size={18} className="text-gray-500"/> <span className="font-bold text-gray-800">추가 옵션 선택</span></div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                              <div><label className="block text-xs font-bold mb-1 text-gray-600">보험 가입</label><select className="w-full p-2 border border-gray-200 rounded-lg text-sm" value={JSON.stringify(insurance)} onChange={e => setInsurance(JSON.parse(e.target.value))}>{siteConfig.options.insurance.map((opt, i) => <option key={i} value={JSON.stringify(opt)}>{opt.name} {opt.price > 0 ? `(+${opt.price.toLocaleString()}원)` : ''}</option>)}</select></div>
                              <div><label className="block text-xs font-bold mb-1 text-gray-600">제휴카드</label><select className="w-full p-2 border border-gray-200 rounded-lg text-sm" value={JSON.stringify(cardApply)} onChange={e => setCardApply(JSON.parse(e.target.value))}>{siteConfig.options.cards.map((opt, i) => <option key={i} value={JSON.stringify(opt)}>{opt.name}</option>)}</select></div>
                              <div><label className="block text-xs font-bold mb-1 text-gray-600">필수팩</label><select className="w-full p-2 border border-gray-200 rounded-lg text-sm" value={JSON.stringify(packApply)} onChange={e => setPackApply(JSON.parse(e.target.value))}>{siteConfig.options.packs.map((opt, i) => <option key={i} value={JSON.stringify(opt)}>{opt.name}</option>)}</select></div>
                              <div><label className="block text-xs font-bold mb-1 text-gray-600">결합할인</label><select className="w-full p-2 border border-gray-200 rounded-lg text-sm" value={JSON.stringify(combination)} onChange={e => setCombination(JSON.parse(e.target.value))}>{siteConfig.options.combinations.map((opt, i) => <option key={i} value={JSON.stringify(opt)}>{opt.name}</option>)}</select></div>
                            </div>
                            
                            {(combination.type === 'total' || combination.name.includes('프리미엄 가족결합')) && (
                                <div className="mt-2 p-4 bg-blue-50 rounded-xl border border-blue-100 animate-fade-in">
                                    <label className="block text-xs font-bold mb-2 text-blue-800">가족 구성원 요금 입력 (본인 제외, 최대 7명)</label>
                                    <div className="grid grid-cols-2 gap-2">
                                        {familyFees.map((fee, index) => (
                                            <input 
                                                key={index}
                                                type="number" 
                                                placeholder={`가족${index + 1} 요금`} 
                                                className="w-full p-2 border border-blue-200 rounded text-sm focus:outline-none focus:border-blue-500 bg-white"
                                                value={fee}
                                                onChange={(e) => handleFamilyFeeChange(index, e.target.value)}
                                            />
                                        ))}
                                    </div>
                                    <div className="text-right mt-2 text-blue-600 font-bold text-sm">
                                        가족 합계: {getFamilyFeeSum().toLocaleString()}원
                                    </div>
                                    <p className="text-[10px] text-blue-500 mt-1">* 입력하신 가족 요금 합계에 따라 할인이 적용 및 기록됩니다.</p>
                                </div>
                            )}
                        </div>

                        {/* [수정] 할인 방법 선택 영역 (2년 총 혜택 비교 표시) */}
                        <div className="bg-white p-5 rounded-xl border border-gray-200">
                          <label className="block text-sm font-bold mb-3 text-gray-800">할인 방법 (2년 총 혜택 비교)</label>
                          <div className="grid grid-cols-2 gap-3">
                            {/* 공통지원금 옵션 */}
                            <div onClick={() => setDiscountType('subsidy')} className={`p-4 border rounded-xl cursor-pointer transition relative overflow-hidden ${discountType === 'subsidy' ? 'border-red-600 bg-white ring-1 ring-red-600 shadow-sm' : 'border-gray-200 bg-white hover:border-gray-300'}`}>
                                {compareDiscounts.subsidy > compareDiscounts.contract && <div className="absolute top-0 right-0 bg-red-600 text-white text-[10px] px-2 py-0.5 rounded-bl-lg font-bold z-10">추천 (혜택↑)</div>}
                                <div className="font-bold text-gray-900 mb-1">공통지원금</div>
                                <div className="text-red-600 font-bold text-lg">총 {compareDiscounts.subsidy.toLocaleString()}원</div>
                                <div className="text-xs text-gray-500 mt-1">기기값 선할인 (공통+추가)</div>
                            </div>
                            {/* 선택약정 옵션 */}
                            <div onClick={() => setDiscountType('contract')} className={`p-4 border rounded-xl cursor-pointer transition relative overflow-hidden ${discountType === 'contract' ? 'border-red-600 bg-white ring-1 ring-red-600 shadow-sm' : 'border-gray-200 bg-white hover:border-gray-300'}`}>
                                {compareDiscounts.contract > compareDiscounts.subsidy && <div className="absolute top-0 right-0 bg-red-600 text-white text-[10px] px-2 py-0.5 rounded-bl-lg font-bold z-10">추천 (혜택↑)</div>}
                                <div className="font-bold text-gray-900 mb-1">선택약정</div>
                                <div className="text-red-600 font-bold text-lg">총 {compareDiscounts.contract.toLocaleString()}원</div>
                                <div className="text-xs text-gray-500 mt-1">요금 25% + 추가지원금</div>
                            </div>
                          </div>
                        </div>

                        <div>
                          <label className="block text-sm font-bold mb-2 text-gray-800">할부 기간</label>
                          <div className="flex gap-2">{[24, 30, 36, 48].map(month => (<button key={month} onClick={() => setInstallmentPeriod(month)} className={`flex-1 py-2 border rounded-lg text-sm font-medium transition ${installmentPeriod === month ? 'border-red-600 bg-red-50 text-red-700' : 'border-gray-300 text-gray-600'}`}>{month}개월</button>))}</div>
                        </div>
                        {/* ... (신청자 정보 및 하단 요금 계산 영역 동일) ... */}
                        <div className="bg-white p-5 rounded-xl border border-gray-200 shadow-sm mt-6">
                          <div className="flex items-center gap-2 mb-3"><span className="font-bold text-gray-800 text-lg">신청자 정보</span><span className="text-xs text-red-500 font-medium">* 필수 입력</span></div>
                          <div className="space-y-3">
                            <div><input type="text" placeholder="이름" className="w-full p-3 border border-gray-200 rounded-lg outline-none focus:border-red-500 text-sm bg-gray-50 focus:bg-white transition-colors" value={customerName} onChange={(e) => setCustomerName(e.target.value)} /></div>
                            <div><input type="tel" placeholder="연락처 (예: 010-1234-5678)" className="w-full p-3 border border-gray-200 rounded-lg outline-none focus:border-red-500 text-sm bg-gray-50 focus:bg-white transition-colors" value={customerPhone} onChange={(e) => setCustomerPhone(e.target.value)} /></div>
                          </div>
                        </div>
                        <div className="border-t-2 border-gray-900 pt-6 mt-8">
                            <div className="space-y-3 mb-6">
                              <div className="flex justify-between text-gray-500"><span>출고가</span><span>{(product.prices && product.prices[selectedCapacity] ? product.prices[selectedCapacity] : 0).toLocaleString()}원</span></div>
                              <div className="flex justify-between text-gray-500 font-bold text-red-500">
                                  {discountType === 'subsidy' ? (
                                      <div className="w-full">
                                          <div className="flex justify-between mb-1">
                                              <span>공통지원금</span>
                                              <span>-{calcResult.finalPublicSupport.toLocaleString()}원</span>
                                          </div>
                                          {calcResult.finalAddSupport > 0 && (
                                              <div className="flex justify-between">
                                                  <span>추가 지원금</span>
                                                  <span>-{calcResult.finalAddSupport.toLocaleString()}원</span>
                                              </div>
                                          )}
                                      </div>
                                  ) : (
                                       <div className="w-full">
                                           {calcResult.finalAddSupport > 0 ? (
                                              <div className="flex justify-between">
                                                  <span>추가 지원금</span>
                                                  <span>-{calcResult.finalAddSupport.toLocaleString()}원</span>
                                              </div>
                                           ) : (
                                              <div className="flex justify-between"><span>공통지원금</span><span>0원</span></div>
                                           )}
                                       </div>
                                  )}
                              </div>
                              <div className="border-t border-dashed border-gray-200 my-2"></div>
                              <div className="flex justify-between text-gray-800 font-bold"><span>월 할부금 (단말기)</span><span>{calcResult.monthlyDevice.toLocaleString()}원</span></div>
                              <div className="flex justify-between text-gray-800 font-bold mt-2"><span>월 통신료 (요금제)</span><span>{calcResult.basePlanFee.toLocaleString()}원</span></div>
                              <div className="bg-red-50 p-4 rounded-lg text-sm space-y-1 mt-2">
                                   <div className="font-bold text-red-600 mb-2 border-b border-red-100 pb-1">▼ 월 요금 할인 내역</div>
                                   {calcResult.contractDiscount > 0 && (<div className="flex justify-between text-gray-600"><span>선택약정 할인</span><span>-{calcResult.contractDiscount.toLocaleString()}원</span></div>)}
                                   {calcResult.comboDiscount > 0 && (<div className="flex justify-between text-gray-600"><span>결합 할인</span><span>-{calcResult.comboDiscount.toLocaleString()}원</span></div>)}
                                   {calcResult.cardDiscount > 0 && (<div className="flex justify-between text-gray-600"><span>제휴카드 할인</span><span>-{calcResult.cardDiscount.toLocaleString()}원</span></div>)}
                                   {calcResult.insuranceDiscount > 0 && (<div className="flex justify-between text-gray-600"><span>멤버십 보험 할인</span><span>-{calcResult.insuranceDiscount.toLocaleString()}원</span></div>)}
                                   {(calcResult.contractDiscount === 0 && calcResult.comboDiscount === 0 && calcResult.cardDiscount === 0 && calcResult.insuranceDiscount === 0) && (<div className="text-gray-400 text-center text-xs">적용된 추가 할인이 없습니다.</div>)}
                                   <div className="mt-2 text-xs text-gray-500 text-right border-t border-red-100 pt-2">
                                      * 정확한 할인내용은 접수 후 상담을 통해 확인 가능합니다.
                                   </div>
                              </div>
                              {(insurance.price > 0 || packApply.price > 0) && (<div className="flex justify-between text-gray-500 mt-2 text-sm"><span>부가서비스(보험/팩)</span><span>+{((insurance.price || 0) + (packApply.price || 0)).toLocaleString()}원</span></div>)}
                            </div>
                            <div className="flex justify-between items-center bg-gray-50 p-6 rounded-xl">
                              <span className="font-bold text-xl text-gray-900">월 예상 납부금액</span>
                              <div className="text-right">
                                  <span className="text-3xl font-extrabold text-red-600">{calcResult.totalMonthly.toLocaleString()}</span>
                                  <span className="text-lg font-bold text-gray-900">원</span>
                                  <p className="text-xs text-gray-400 mt-1">VAT 및 할부수수료(5.9%) 포함 {calcResult.insuranceDiscountMsg && <span className="text-blue-500 ml-1">{calcResult.insuranceDiscountMsg}</span>}</p>
                              </div>
                            </div>
                        </div>
                        <div className="flex gap-3">
                            <button onClick={handleOrder} className="flex-1 py-4 border border-gray-300 rounded-xl font-bold text-gray-700 hover:bg-gray-50 hover:border-gray-400 transition">이메일 상담 접수</button>
                            <button onClick={handleKakaoConsult} className="flex-[2] py-4 bg-[#FAE100] text-[#371D1E] rounded-xl font-bold text-lg hover:bg-[#F9E000] shadow-lg transition flex items-center justify-center gap-2"><IconMessage size={20} fill="currentColor" /> 카카오톡 상담접수</button>
                        </div>
                      </div>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        const App = () => {
          const [currentView, setCurrentView] = useState('home'); 
          const [selectedProduct, setSelectedProduct] = useState(null);
          const [showConsult, setShowConsult] = useState(true);
          const [showPreOrderModal, setShowPreOrderModal] = useState(false);
          const [preOrderForm, setPreOrderForm] = useState({ model: SITE_CONFIG.preOrder.models[0], name: '', phone: '' });

          useEffect(() => {
            const script = document.createElement('script');
            script.src = "https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js";
            script.async = true;
            script.onload = () => { if (window.emailjs && SITE_CONFIG.email.publicKey) window.emailjs.init(SITE_CONFIG.email.publicKey); };
            document.body.appendChild(script);
          }, []);

          const handleProductClick = (product) => { setSelectedProduct(product); setCurrentView('detail'); window.scrollTo(0, 0); };
          const handleBack = () => { setCurrentView('home'); setSelectedProduct(null); window.scrollTo(0, 0); };

          const handlePreOrderSubmit = (e) => {
              e.preventDefault();
              if (!window.emailjs) { alert('메일 서버 연결 중입니다. 잠시 후 다시 시도해주세요.'); return; }
              const params = { name: preOrderForm.name, phone: preOrderForm.phone, branch: '사전예약', promo_item: `[사전예약 알림신청]\n이름: ${preOrderForm.name}\n관심모델: ${preOrderForm.model}\n연락처: ${preOrderForm.phone}`, date: new Date().toLocaleString(), manager_email: SITE_CONFIG.email.managerEmail };
              window.emailjs.send(SITE_CONFIG.email.serviceId, SITE_CONFIG.email.templateId, params).then(() => { alert('사전예약 알림 신청이 완료되었습니다.'); setShowPreOrderModal(false); setPreOrderForm({ ...preOrderForm, name: '', phone: '' }); }).catch(err => alert('전송 실패: ' + JSON.stringify(err)));
          };

          return (
            <div className="min-h-screen bg-white font-sans text-gray-900 selection:bg-red-100 selection:text-red-900">
              <div className="bg-gray-100 text-[10px] sm:text-xs py-2 px-4 border-b border-gray-200">
                <div className="max-w-7xl mx-auto flex justify-between items-center text-gray-500"><span>{SITE_CONFIG.info.topBannerText}</span><div className="flex gap-4"></div></div>
              </div>
              <header className="sticky top-0 z-50 bg-white shadow-lg shadow-gray-200/50">
                <div className="relative z-20 bg-white">
                    <div className="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                      <div className="flex items-center cursor-pointer group" onClick={handleBack}><img src={SITE_CONFIG.info.logoImg} alt="KT Store Logo" className="h-9 md:h-11 object-contain mr-2 transition-transform duration-300 group-hover:scale-105" /></div>
                      <div className="flex items-center space-x-2"></div>
                    </div>
                </div>
                <div className="relative z-10 bg-slate-50 border-t border-gray-200 shadow-[inset_0_2px_4px_rgba(0,0,0,0.02)]">
                    <nav className="max-w-7xl mx-auto px-4 flex space-x-8 overflow-x-auto whitespace-nowrap scrollbar-hide py-3 md:justify-start">
                        <button onClick={() => document.getElementById('products')?.scrollIntoView({behavior:'smooth'})} className="text-sm md:text-base font-bold text-gray-500 hover:text-gray-900 transition-colors relative group py-1">이달의 특가폰<span className="absolute bottom-0 left-0 w-0 h-0.5 bg-red-600 transition-all duration-300 group-hover:w-full"></span></button>
                        <button onClick={() => document.getElementById('internet')?.scrollIntoView({behavior:'smooth'})} className="text-sm md:text-base font-bold text-gray-500 hover:text-gray-900 transition-colors relative group py-1">초고속 인터넷/지니TV<span className="absolute bottom-0 left-0 w-0 h-0.5 bg-red-600 transition-all duration-300 group-hover:w-full"></span></button>
                        {SITE_CONFIG.preOrder.isActive && (<button onClick={() => setShowPreOrderModal(true)} className="text-sm md:text-base font-bold text-red-500 hover:text-red-700 transition-colors relative group py-1">사전예약<span className="absolute bottom-0 left-0 w-0 h-0.5 bg-red-600 transition-all duration-300 group-hover:w-full"></span></button>)}
                    </nav>
                </div>
              </header>

              {currentView === 'home' ? (
                <HomePage 
                   siteConfig={SITE_CONFIG}
                   plans={PLANS}
                   reviews={SITE_CONFIG.reviews} // FIXED: Passed explicitly from SITE_CONFIG
                   onProductClick={handleProductClick} 
                   showPreOrderModal={showPreOrderModal} 
                   setShowPreOrderModal={setShowPreOrderModal} 
                />
              ) : (
                <ProductDetailPage 
                    product={selectedProduct} 
                    plans={PLANS} 
                    siteConfig={SITE_CONFIG} 
                    onBack={handleBack} 
                />
              )}
              
              {showPreOrderModal && (
                <div className="fixed inset-0 z-[100] flex items-center justify-center bg-black/70 backdrop-blur-sm p-4 animate-fade-in">
                  <div className="bg-white rounded-3xl p-8 max-w-lg w-full relative shadow-2xl animate-scale-up border-2 border-red-500 overflow-hidden">
                    <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-red-500 to-purple-500"></div>
                    <div className="absolute -bottom-10 -right-10 w-40 h-40 bg-red-50 rounded-full blur-2xl"></div>
                    <button onClick={() => setShowPreOrderModal(false)} className="absolute top-4 right-4 text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-full transition"><IconX size={24} /></button>
                    <div className="text-center mb-8 relative z-10"><span className="bg-red-100 text-red-600 text-xs font-bold px-3 py-1 rounded-full mb-3 inline-block animate-pulse">{SITE_CONFIG.preOrder.badge}</span><h2 className="text-3xl font-extrabold text-gray-900 mb-2">{SITE_CONFIG.preOrder.title}</h2><p className="text-gray-500 text-sm" dangerouslySetInnerHTML={{ __html: SITE_CONFIG.preOrder.description }}></p></div>
                    <form onSubmit={handlePreOrderSubmit} className="space-y-4 relative z-10">
                      <div className="space-y-2">
                        <p className="text-sm font-bold text-gray-700">관심 모델 선택</p>
                        <div className="grid grid-cols-2 gap-2">{SITE_CONFIG.preOrder.models.map((model) => (<label key={model} className="border rounded-xl p-3 text-center cursor-pointer text-sm font-medium transition border-gray-200 hover:bg-gray-50"><input type="radio" name="preOrderModel" value={model} className="mr-2" checked={preOrderForm.model === model} onChange={(e) => setPreOrderForm({...preOrderForm, model: e.target.value})}/>{model}</label>))}</div>
                      </div>
                      <div className="pt-2 space-y-3">
                        <input type="text" placeholder="이름" className="w-full bg-gray-50 border border-gray-200 rounded-xl p-4 text-gray-900 focus:border-red-500 outline-none transition-colors" required value={preOrderForm.name} onChange={(e) => setPreOrderForm({...preOrderForm, name: e.target.value})}/>
                        <input type="tel" placeholder="알림 받을 연락처 (010-0000-0000)" className="w-full bg-gray-50 border border-gray-200 rounded-xl p-4 text-gray-900 focus:border-red-500 outline-none transition-colors" required value={preOrderForm.phone} onChange={(e) => setPreOrderForm({...preOrderForm, phone: e.target.value})}/>
                      </div>
                      <button type="submit" className="w-full bg-slate-900 text-white py-4 rounded-xl font-bold text-lg hover:bg-slate-800 transition shadow-lg">알림 신청하기</button>
                    </form>
                  </div>
                </div>
              )}

              <div className="fixed bottom-6 right-6 z-40 flex flex-col gap-3">
                 {showConsult && (
                   <div className="bg-white p-4 rounded-xl shadow-2xl border border-gray-100 w-64 animate-fade-in-up mb-2 relative">
                      <button onClick={() => setShowConsult(false)} className="absolute top-2 right-2 text-gray-300 hover:text-gray-500"><IconX size={16}/></button>
                      <div className="font-bold text-gray-900 mb-1">무엇을 도와드릴까요?</div>
                      <p className="text-xs text-gray-500 mb-3">전문 상담사가 최적의 요금제를 찾아드립니다.</p>
                      <a href={SITE_CONFIG.info.kakaoUrl} target="_blank" rel="noreferrer" className="w-full bg-yellow-300 text-black text-sm font-bold py-2 rounded flex items-center justify-center gap-1 hover:bg-yellow-400 cursor-pointer"><IconMessage size={16}/> 카카오톡 상담</a>
                   </div>
                 )}
                 <button onClick={() => setShowConsult(!showConsult)} className="bg-red-600 text-white w-14 h-14 rounded-full shadow-xl flex items-center justify-center hover:bg-red-700 hover:scale-105 transition duration-300"><IconPhone size={24} /></button>
              </div>

              <footer className="bg-gray-100 border-t border-gray-200 pt-12 pb-8">
                <div className="max-w-7xl mx-auto px-4">
                  <div className="flex flex-col items-start text-left mb-6 text-xs text-gray-600">
                      <div className="w-full">
                          <h5 className="font-bold text-gray-900 mb-4 text-sm">사업자 정보</h5>
                          <p className="font-bold mb-1">{SITE_CONFIG.info.companyName}</p>
                          <p className="mb-1">대표자: {SITE_CONFIG.info.representative} | 사업자등록번호: {SITE_CONFIG.info.businessNumber}</p>
                          <p className="mb-1">주소: {SITE_CONFIG.info.address}</p>
                          <p className="mb-1">통신판매업신고: {SITE_CONFIG.info.telecomNumber} | 개인정보관리책임자: {SITE_CONFIG.info.privacyManager}</p>
                      </div>
                  </div>
                  <div className="bg-white p-6 rounded-2xl border border-gray-200 shadow-sm mb-8 w-full md:w-auto md:inline-block">
                      <div className="flex flex-wrap items-center gap-6 justify-center md:justify-start">
                          {SITE_CONFIG.info.kaitLogoHtml && (<div className="flex items-center" dangerouslySetInnerHTML={{ __html: SITE_CONFIG.info.kaitLogoHtml }}></div>)}
                          <div className="w-px h-8 bg-gray-200 hidden md:block"></div>
                          <a href={SITE_CONFIG.info.ftcLink} target="_blank" rel="noreferrer"><img src={SITE_CONFIG.info.ftcLogo} alt="공정거래위원회" className="h-10 md:h-12 object-contain hover:opacity-80 transition-opacity" /></a>
                      </div>
                  </div>
                  <div className="border-t border-gray-200 pt-8 text-center text-xs text-gray-400">COPYRIGHT © KT GAURI. ALL RIGHTS RESERVED.</div>
                </div>
              </footer>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
